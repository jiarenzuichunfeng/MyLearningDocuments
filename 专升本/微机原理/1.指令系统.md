# 指令系统

## 指令格式及寻址方式

* 指令格式
  * 指令系统：计算机能执行的全部指令
  * 程序：一条条指令的集合或指令序列
* 指令的一般格式
  * ![image-20250311162947823](E:\study\lianxi\Doc\images\image-20250311162947823.png)
  * 操作码：指明指令要进行什么操作，汇编语言用指令的助记符表示
  * 操作数：指令操作过程中所需的操作数据或操作数存放的地址

## 寻址方式

* 寻址方式：指令获得操作数的方法（操作数所处的确切位置）
  * 8086/8088寻址方式分为四大类
    * 立即寻址
      * 立即寻址：操作数直接放在指令中，紧跟操作码之后，作为指令一部分放在代码段中。操作数成为立即数
      * 例：MOV AX，1234H
    * 寄存器寻址
      * 寄存器寻址：操作数就在寄存器中，这种寻址方式，操作在CPU内部进行，不需要总线周期，因此执行速度快。操作数成为寄存器操作数
      * 例：MOV AX，BX
    * 存储器寻址
      * 存储器寻址：操作数存放在存储器中（数据段（DS）、附加段（ES）、堆栈段（SS））。操作数称为存储器操作数
      * 根据给出有效地址（EA）的方式不同，存储器寻址又分为：
        * 直接寻址
          * 直接寻址：存储器操作数的有效地址由指令直接给出，跟在操作码后，作为指令一部分放在代码段（CS）中。
          * 直接寻址注意：
            * 若指令没有使用段前缀，则默认段寄存器是DS
            * 例如：MOV AX，[1000H]
              单元的物理地址=DS*16+1000H
            * 若操作数放在其他段，则必须使用段前缀指明。
            * 例如：MOV AX，ES:[2000H]
              单元的物理地址=ES*16+2000H
        * 寄存器间接寻址
          * 寄存器间接寻址：存储器操作数的有效地址放在BX、BP（基址寄存器）、SI、DI（变址寄存器）寄存中。
          * 寄存器间接寻址说明：
            * 若指令中使用BX、SI、DI，则默认操作数在数据段上。
              则单元的物理地址=DS*16+BX/SI/DI
            * 若指令中使用BP，则默认操作数在堆栈段上。
              则单元的物理地址=SS*16+BP
            * 若使用段前缀，优先于其他。
            * 例如：MOV AX，SS:[BX]
              则单元的物理地址=SS*16+BX
        * 相对寄存器寻址
          * 相对寄存器寻址：存储器操作数的有效地址由BX、BP、SI、DI值加上指令中的8位/16位偏移量
          * 例：MOV AX，COUNT[SI]
          * 相对寄存器间接寻址说明：
            * 若指令中使用BX、SI、DI，则默认操作数在数据段上。
              则单元的物理地址=DS*16+BX/SI/DI+8位/16位偏移量
            * 若指令中使用BP，则默认操作数在堆栈段上。
              则单元的物理地址=SS*16+BP+8位/16位偏移量
            * 若使用段前缀，优先于其他。
            * 例如：MOV AX，SS:[BX]
              则单元的物理地址=SS*16+BX+8位/16位偏移量
        * 基址变址寻址
          * 基址变址寻址：存储器操作数的有效地址由基址寄存器BX、BP加上变址寄存器SI、DI的和。
          * 例：MOV AX，[BX] [DI]
          * 基址变址寻址说明：
            * 若指令中使用BX，则操作数默认在数据端上。
              则单元的物理地址=DS*16+BX+SI/DI
            * 若指令中使用BP，则操作数默认在堆栈段上。
              则单元的物理地址=SS*16+BP+SI/DI
        * 相对基址变址寻址
          * 相对基址变址寻址：存储器操作数的有效地址由基址寄存器BX、BP加上变址寄存器SI、DI再加上8位/16位偏移量。
          * 例：MOV AX，MASK [BX] [SI]
    * I/O端口寻址
      * I/O端口寻址:
        * 端口编址方式有两种
          * 统一
          * 单独（独立）
      * 8086/8088端口是单独编址的，有自己的寻址方式：
        * 8086/8088端口寻址方式分为
          * 直接端口寻址（端口地址不超过八位）
            * 直接端口寻址：端口地址由指令直接提供一个8位立即数，可寻址256个端口地址
            * 例：IN AL/AX，63H
                    OUT 64H，AL/AX
          * 间接端口寻址（端口地址超过八位）
            * 间接端口寻址：端口地址是用DX寄存器给出，可寻址64K个端口地址
            * 例：IN AL/AX，DX
                    OUT 64H，AL/AX